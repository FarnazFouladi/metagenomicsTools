rm(list=ls())

setwd("G:\\BigDataScalingFactors\\July_StoolRemoved");

myT <- read.table("risk_raw_countsTaxaAsColumnsStoolOnly.txt", sep="\t", header=TRUE,row.names=1)
myTNorm <- read.table("risk_raw_countsTaxaAsColumnsStoolOnlyNormalized.txt", sep="\t", header=TRUE, row.names=1)



rowSums <- apply(myT, 1, sum)


meanSubtractedT <- matrix(nrow=nrow(myT), ncol=ncol(myT))

for( i in 1:ncol(meanSubtractedT ))
{
	meanSubtractedT[,i] = myT[,i] - mean(myT[,i])
}

aCov <- cov(myT)
anEigen <- eigen(cov(myT))
comps<- meanSubtractedT %*% anEigen$vectors
plot(log10(rowSums),comps[,1])

compsFirst5<- meanSubtractedT %*% anEigen$vectors[,1:5]
plot(log10(rowSums),compsFirst5[,1])
