rm(list=ls())

homemadeT <- function( df  ) 
{
	topPart <- rnorm(1)
	
	bottomPart <- 0
	
	for ( i in 1: df)
	{
		val = rnorm(1)
		bottomPart = bottomPart + val*val
	}
	
	return (topPart/sqrt(bottomPart/df))
}

numTrials <- 100000
vals <- vector(length=100000)
my_df <- 5

for (i in 1:numTrials)
{
	vals[i] = homemadeT(my_df )
}

myHist <- hist( vals, breaks=20)
lines( myHist$mids, dt( myHist$mids, my_df ) * numTrials, col="red")