rm(list=ls())

library(gamlss) 
library(gamlss.dist) # gamlss.dist package, contains inflated

setwd("C:\\Users\\corei7\\git\\metagenomicsTools\\src\\gamlssDemo")

myT <- read.table("genusPivotedTaxaAsColumnsNorm.txt", row.names=1,
		header=TRUE)

myFrame <- data.frame( bug = myT[,4])

#fit <- gamlss( bug~1,sigma.formula=~1, nu.formula=~1, family = BEZI, data = myFrame)
fit <- gamlss( bug~1,family = BEZI, data = myFrame)

fit$mu.coefficients
fit$sigma.coefficients
fit$nu.coefficients

myHist <- hist(myFrame$bug,breaks=20,prob=TRUE)

normVals <- dnorm( myHist$mids, mean=mean(myFrame$bug), sd= sd(myFrame$bug)  )
lines( myHist$mids, normVals, col="RED")

