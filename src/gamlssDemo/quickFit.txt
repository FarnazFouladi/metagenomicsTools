rm(list=ls())

library(gamlss) 
library(gamlss.dist) # gamlss.dist package, contains inflated

setwd("C:\\Users\\corei7\\git\\metagenomicsTools\\src\\gamlssDemo")

myT <- read.table("genusPivotedTaxaAsColumnsNormCaseContol.txt", row.names=1,
		header=TRUE)

myFrame <- data.frame( bug = myT[,4], isCase = grepl("case",row.names(myT))	)

fit <- gamlss( bug~isCase,sigma.formula=~isCase, nu.formula=~isCase, family = BEZI, data = myFrame)

fit$mu.coefficients
fit$sigma.coefficients
fit$nu.coefficients
summary(fit)

myHist <- hist(myFrame$bug,breaks=20,prob=TRUE)

normVals <- dnorm( myHist$mids, mean=mean(myFrame$bug), sd= sd(myFrame$bug)  )
lines( myHist$mids, normVals, col="RED")

