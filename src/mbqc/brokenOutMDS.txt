rm(list=ls())

setwd("G:\\MBQC\\dropbox\\alpha-beta-div\\beta-div")
library("vegan")
dat <- read.csv( "merged_species.txt", sep = "\t" )
metaTable <- read.table("metadataForMergedSpecies.txt",sep="\t",header=TRUE)

whichNAs <- which(!is.na( metaTable$mbqcID ))

dat <- dat[,-1]
dat <- t(dat)
dat <- dat[ whichNAs, ]
metaTable <- metaTable[ whichNAs,]

sampleIDs <- unique( metaTable$mbqcID)
bioinformaticIDS <- unique(metaTable$informaticsToken)

getAnMDS <- function(x, included)
{
 	 x.use = x[included,]
     dist.use = vegdist( x.use, method = "bray" )
 	 cmdscale( dist.use )
}


subSample <- which(metaTable$mbqcID==sampleIDs[1] & metaTable$informaticsToken == bioinformaticIDS[1])
anMDS <- getAnMDS( dat, subSample )

plot(anMDS[,1], anMDS[,2])